!function(a){function t(r){if(n[r])return n[r].exports;var e=n[r]={i:r,l:!1,exports:{}};return a[r].call(e.exports,e,e.exports,t),e.l=!0,e.exports}var n={};t.m=a,t.c=n,t.i=function(a){return a},t.d=function(a,n,r){t.o(a,n)||Object.defineProperty(a,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(a){var n=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(n,"a",n),n},t.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},t.p="",t(t.s=3)}([function(a,t,n){"use strict";function r(a,t,n,r){return a.data[4*(n*a.width+t)+r]}function e(a,t,n,r,e){for(var i=new Uint8ClampedArray(r*e*4),l=n;l<n+e;l++){var f=4*(l*a.width+t),s=f+4*r,o=a.data.slice(f,s),h=(l-n)*r*4;i.set(o,h)}return new ImageData(i,r,e)}function i(a,t){var n=t*a.width*4,r=n+4*a.width,e=a.data.slice(n,r);return new ImageData(e,a.width,1)}function l(a){for(var t=a.width,n=a.height,e=0,i=new ImageData(a.width,a.height),l=new ArrayBuffer(i.data.length),f=new Uint8ClampedArray(l),s=new Uint32Array(l),o=0;o<n;o++)for(var h=0;h<t;h++){var u=r(a,h,o,0),d=r(a,h,o,1),g=r(a,h,o,2),v=parseInt(.299*u+.587*d+.114*g,10);s[o*t+h]=255<<24|v<<16|v<<8|v,e+=v}return i.data.set(f),{imgData:i,threshold:e/(t*n)}}function f(a,t){var n,e,i=a.width,l=a.height,f=[],s=new ImageData(a.width,a.height),o=new ArrayBuffer(s.data.length),h=new Uint8ClampedArray(o),u=new Uint32Array(o),d=[],g=0;for(n=0;n<l;n++){for(d=[],e=0;e<i;e++){var v=Math.max(0,e-1),p=Math.min(i-1,e+1),c=Math.max(0,n-1),m=Math.min(l-1,n+1),D=r(a,p,n,0),O=r(a,v,n,0),y=r(a,e,m,0),w=r(a,e,c,0),E=Math.abs(D-O),x=Math.abs(y-w),M=parseInt((E+x)/2,10);g+=M;var L=parseInt(180*(0===E?0:Math.atan(x/E))/Math.PI,10),A=E>=0&&x>=0?1:-1;M=Math.abs(M),u[n*i+e]=255<<24|M<<16|M<<8|M,d.push([L,A])}f.push(d)}return s.data.set(h),{imgData:s,gradient:f,threshold:g/(i*l)}}function s(a,t){for(var n=a.width,e=a.height,i=new ImageData(a.width,a.height),l=new ArrayBuffer(i.data.length),f=new Uint8ClampedArray(l),s=new Uint32Array(l),o=0;o<e;o++)for(var h=0;h<n;h++){var u=r(a,h,o,0),d=u>=t?255:0;s[o*n+h]=255<<24|d<<16|d<<8|d}return i.data.set(f),i}function o(a,t){var n=f(a,t);return{imgData:s(n.imgData,n.threshold),gradient:n.gradient}}a.exports={getRect:e,getRow:i,convertToGrayscale:l,gradientSimple:f,binarize:s,gradientAndBinarize:o}},function(a,t,n){"use strict";function r(a){var t,n,r=a.length,e=[],i=null,l=0;for(t=0;t<r;t++)n=a[t],n!==i&&null!=i&&(e.push({val:i,len:l}),l=0),l++,i=n;l>0&&e.push({val:i,len:l});var f=e.length,s=255===e[0].val?1:0,o=255===e[f-1].val?f-1:f;return e.slice(s,o)}function e(a){var t,n,r=[],e=[];if(a.length>=59){var i=a.length-59+1;for(t=0;t<i;t++){for(e=[],n=0;n<6;n++){var l=t+3+4*n,f=a.slice(l,l+4);e.push(f)}for(n=6;n<12;n++){var s=t+3+5+4*n,o=a.slice(s,s+4);e.push(o)}r.push(e)}}return r}function i(a){var t,n=[];for(var r in a){var e=a[r];t=0;for(var i in e){t+=e[i].len}var l=[];for(var f in e)l.push(e[f].len/t);n.push(l)}return n}function l(a,t){return(a%t+t)%t}function f(a){var t,n,r,e={leftDigitsOdd:[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2]],leftDigitsEven:[[1,1,2,3],[1,2,2,2],[2,2,1,2],[1,1,4,1],[2,3,1,1],[1,3,2,1],[4,1,1,1],[2,1,3,1],[3,1,2,1],[2,1,1,3]],rightDigits:[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2]],parity:["OOOOOO","OOEOEE","OOEEOE","OOEEEO","OEOOEE","OEEOOE","OEEEOO","OEOEOE","OEOEEO","OEEOEO"]};for(n in e.leftDigitsOdd){var i=e.leftDigitsOdd[n];t=0;for(var f in i)t+=i[f];for(var s in i)i[s]=i[s]/t}for(n in e.leftDigitsEven){var o=e.leftDigitsEven[n];t=0;for(var h in o)t+=o[h];for(var u in o)o[u]=o[u]/t}for(n in e.rightDigits){var d=e.rightDigits[n];t=0;for(var g in d)t+=d[g];for(var v in d)d[v]=d[v]/t}var p,c=[];for(n=0;n<6;n++){var m=a[n],D=[];for(var O in e.leftDigitsOdd){var y=e.leftDigitsOdd[O];for(p=0,r=0;r<4;r++)p+=Math.abs(y[r]-m[r]);D.push(p)}c.push({odd:D,even:0}),D=[];for(var w in e.leftDigitsEven){var E=e.leftDigitsEven[w];for(p=0,r=0;r<4;r++)p+=Math.abs(E[r]-m[r]);D.push(p)}c[n].even=D}for(n=6;n<12;n++){var x=a[n],M=[];for(var L in e.rightDigits){var A=e.rightDigits[L];for(p=0,r=0;r<4;r++)p+=Math.abs(A[r]-x[r]);M.push(p)}c.push({odd:0,even:M})}var b="",S="";for(var I in c){var G=c[I],X=0;if(I<6){var z=Math.min.apply(Math,G.odd),B=G.odd.indexOf(z),U=Math.min.apply(Math,G.even),N=G.even.indexOf(U);z<U?(X=B,b+="O"):(X=N,b+="E")}else X=G.even.indexOf(Math.min.apply(Math,G.even));S+=X.toString()}var Y=e.parity.indexOf(b).toString();if(parseInt(Y,10)<0)S="false";else{S=Y+S;var C=0;for(n=0;n<12;n++)C+=S[n]*(l(n+1,2)?1:3);!l(10-l(C,10),10)===parseInt(S[12],10)&&(S="false")}return S}a.exports={runLengthEncoding:r,sliceDigits:e,normalizeDigits:i,findSimilarNumbers:f}},function(a,t,n){"use strict";function r(a,t,n,r){return a.data[4*(n*a.width+t)+r]}function e(a,t,n,e){for(var i=a.width,l=a.height,f=i,s=Math.floor(l/(l*n)),o=f*e.maxDist/100,h=f*e.minLength/100,u=[],d=0;d<l;d+=s)for(var g=0;g<i-h;g++)if(255===r(a,g,d,0)){for(var v=t[d][g][0],p=v,c=0,m=1,D=0,O={x:null,y:null,scanlineLength:0,angleAVG:null},y=g+1;y<i;y++){c++;var w=r(a,y,d,0),E=t[d][y][0];if(255===w&&E>=v-e.angleDiff&&E<=v+e.angleDiff?(m++,p+=E,D=0):D++,D>o||y===i-1){m>=e.minGradient&&(O={x:g,y:d,scanlineLength:c-D,angleAVG:parseInt(p/m,10)});break}}O.scanlineLength>=h&&u.push(O),g=Math.min(i-1,g+O.scanlineLength)}return u}function i(a,t,n){for(var r=[],e=a,i=e*n.maxSLDist/100,l=e*n.maxLengthDiff/100,f=e*n.maxSLDiffX/100,s=0;s<t.length-n.minSLNumber;s++){var o=t[s],h=o.scanlineLength,u=o.angleAVG,d=o.x,g=o.y,v=[];v.push(o);for(var p=s,c=s+1;c<t.length;c++){var m=t[c];if(!(m.y<=g+i))break;m.y!==g&&m.x>=d-f&&m.x<=d+f&&m.angleAVG>=u-n.angleDiff&&m.angleAVG<=u+n.angleDiff&&m.scanlineLength>=h-l&&m.scanlineLength<=h+l&&(v.push(m),p=c,h=m.scanlineLength,u=m.angleAVG,d=m.x,g=m.y)}v.length>=n.minSLNumber?r.push(v):p=s,s=p}return r}function l(a,t,n,r){var l=a.width,f=Math.floor(l*r.locBorder/100),s=e(a,t,n,r),o=i(a.width,s,r),h=[];for(var u in o){var d=o[u],g=[],v=[],p=[];for(var c in d){var m=d[c];g.push(m.x),v.push(m.x+m.scanlineLength),p.push(m.y)}h.push({startX:Math.min.apply(null,g)-f,endX:Math.max.apply(null,v)+f,startY:Math.min.apply(null,p)-0,endY:Math.max.apply(null,p)+0})}return h}a.exports={findScanlines:e,findPBCAfromSLs:i,localizationSLA:l}},function(a,t,n){"use strict";function r(a){if(a&&a.__esModule)return a;var t={};if(null!=a)for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n]);return t.default=a,t}var e=n(0),i=r(e),l=n(1),f=r(l),s=n(2),o=r(s),h=[.5,.4,.6,.3,.7,.2,.8,.1,.9],u=[-1,0,1,-2,0,2,-1,0,1],d={locBorder:0,angleDiff:11,maxDist:1.7,minLength:17,minGradient:100,maxSLDist:1.5,maxLengthDiff:2,maxSLDiffX:2,minSLNumber:parseInt(1/3*25,10)};self.onmessage=function(a){if(a.data.imgData){var t=i.convertToGrayscale(a.data.imgData),n=i.gradientAndBinarize(t.imgData,u),r=[];r=o.localizationSLA(n.imgData,n.gradient,1/3,d),n.imgData=null,n.gradient=null,n=null;var e=0,l=[];for(var s in r){var g=r[s],v=Math.max(0,g.endX-g.startX)*Math.max(0,g.endY-g.startY);v>e&&(e=v,l=[],l.push(g))}var p=[],c=void 0;for(var m in r){var D="false",O=r[m];c=i.getRect(t.imgData,O.startX,O.startY,O.endX-O.startX,O.endY-O.startY);for(var y in h){var w=Math.floor(c.height*h[y]),E=i.getRow(c,w),x=E.data.reduce(function(a,t,n){return n%4==0?a+t:a},0),M=i.binarize(E,x/E.width),L=new Uint8ClampedArray(E.width);M.data.reduce(function(a,t,n){return n%4==0&&(a[n/4]=t),a},L);var A=f.runLengthEncoding(L),b=f.sliceDigits(A);for(var S in b){var I=b[S];if(12===I.length){var G=f.normalizeDigits(I);if("false"!==(D=f.findSimilarNumbers(G))){p.push(D);break}}else D="false"}if("false"!==D)break}}t.imgData=null,r=null,c=null,l=null,postMessage({type:"decoding",id:a.data.id,payload:{EAN:p}})}else postMessage({type:"decoding",id:a.data.id,payload:{EAN:[]}})},postMessage({type:"status",payload:{status:"ready"}})}]);